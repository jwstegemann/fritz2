<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Store Mapping</title>
    <link rel="stylesheet" type="text/css" href="/assets/main.css"/>
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,300,400&display=swap" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css?family=Inter:200,300,400&display=swap" rel="stylesheet"/>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>
    
        <meta name="description" content="Learn how Mapping on Stores will enable elegant state management">
    
    
    
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
    <link rel="manifest" href="/site.webmanifest">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="msapplication-TileColor" content="#2b5797">
    <meta name="theme-color" content="#333333">
</head>
<body class="bg-bg font-sans">


<!-- Background color split screen for large screens -->
<div class="fixed top-0 left-0 w-1/2 h-full bg-bg" aria-hidden="true"></div>
<div class="fixed top-0 right-0 w-1/2 h-full bg-bg" aria-hidden="true"></div>
<div class="relative flex flex-col bg-bg">
<!-- Navbar -->
<nav class="fixed h-16 px-4 z-20 w-full font-nunito text-white bg-bg bg-gray-800">
  <div class="relative flex items-center justify-between h-16">
    <a class="flex items-center justify-start px-0 w-48 hover:text-gray-300 min-w-fit" href="/">
      <!-- fritz2 logo -->
      <svg class="ml-1 h-7 w-7" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
           fill="currentColor" stroke="none" >
          <path d="M 9.987 0.229 C 4.469 0.236 0 4.61 0 10.003 C 0 15.401 4.477 19.777 10 19.777 C 15.523 19.777 20 15.401 20 10.003 C 20 4.605 15.523 0.229 10 0.229 C 9.996 0.229 9.992 0.229 9.987 0.229 Z M 14.678 2.662 C 15.144 2.665 15.52 3.043 15.517 3.506 L 15.5 6.862 C 15.497 7.325 15.118 7.699 14.652 7.696 C 14.187 7.694 13.811 7.316 13.813 6.853 L 12.126 6.844 C 11.661 6.842 11.281 7.216 11.278 7.679 L 11.274 8.501 L 12.052 8.501 C 12.072 8.499 12.092 8.499 12.112 8.499 C 12.575 8.499 12.952 8.882 12.952 9.356 C 12.952 9.829 12.575 10.213 12.112 10.213 C 12.089 10.213 12.066 10.212 12.043 10.21 L 7.111 10.21 L 7.111 10.207 C 7.097 10.208 7.084 10.208 7.071 10.208 C 6.607 10.208 6.231 9.825 6.231 9.353 C 6.231 8.881 6.607 8.498 7.071 8.498 C 7.091 8.498 7.111 8.499 7.131 8.501 L 7.9 8.501 L 7.909 6.823 C 7.918 4.969 9.437 3.474 11.3 3.484 L 13.83 3.497 C 13.833 3.034 14.212 2.66 14.678 2.662 Z M 7.887 10.644 L 11.261 10.662 L 11.248 13.179 C 11.238 15.032 9.72 16.527 7.857 16.517 L 6.17 16.509 C 6.167 16.972 5.787 17.346 5.322 17.343 C 4.856 17.341 4.48 16.963 4.483 16.5 L 4.5 13.144 C 4.502 12.681 4.882 12.307 5.348 12.309 C 5.813 12.312 6.189 12.69 6.187 13.153 L 7.031 13.157 C 7.496 13.159 7.876 12.786 7.878 12.322 Z"/>
        </svg>
        <div class="ml-3">
          <span class="text-2xl">fritz2</span>
          <span class="ml-1 text-xs">1.0-SNAPSHOT</span>
        </div>
    </a>






















    <div class="-mr-2 flex items-center md:hidden">
      <!-- Mobile menu button -->
      <button type="button" id="mobile-menu-button" onclick="toggleMenu()"
              class="p-2 inline-flex items-center justify-center bg-gray-800 rounded-md text-gray-400 hover:bg-gray-900 focus:outline-none focus:ring-1 focus-ring-inset focus:ring-gray-400"
              aria-controls="mobile-menu" aria-expanded="false">
        <span class="sr-only">Open menu</span>
        <span class="mobile-icon block h-6 w-6">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" data-heroicon-name="menu" data-heroicon-style="outline"><title>open main menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"/></svg>
        </span>
        <span class="mobile-icon hidden h-6 w-6">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" data-heroicon-name="x" data-heroicon-style="outline"><title>close main menu</title><path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"/></svg>
        </span>
      </button>
    </div>
    <!-- Links section -->
    <div class="hidden md:block w-24 md:w-48 lg:w-64 ">
      <div class="flex items-center justify-end hover:text-gray-200">
        <!-- Github -->
        <div class="ml-4 relative flex-shrink-0">
          <div>
            <a target="_blank" href="https://github.com/jwstegemann/fritz2">
              <svg class="mr-1 h-6 w-6" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"
                   fill="currentColor" stroke="none" >
                <path d="M 9.983 0 C 4.458 0 -0.017 4.478 -0.017 10 C -0.017 14.419 2.848 18.167 6.821 19.488 C 7.321 19.582 7.504 19.273 7.504 19.007 C 7.504 18.769 7.496 18.14 7.492 17.307 C 4.71 17.91 4.123 15.965 4.123 15.965 C 3.668 14.811 3.011 14.503 3.011 14.503 C 2.105 13.883 3.081 13.895 3.081 13.895 C 4.085 13.965 4.613 14.925 4.613 14.925 C 5.504 16.454 6.953 16.013 7.525 15.757 C 7.615 15.11 7.873 14.669 8.158 14.419 C 5.938 14.169 3.603 13.309 3.603 9.478 C 3.603 8.386 3.991 7.494 4.633 6.794 C 4.52 6.542 4.183 5.525 4.72 4.148 C 4.72 4.148 5.558 3.879 7.47 5.173 C 8.27 4.95 9.12 4.84 9.97 4.835 C 10.82 4.84 11.67 4.95 12.47 5.173 C 14.37 3.879 15.208 4.148 15.208 4.148 C 15.745 5.525 15.408 6.542 15.308 6.794 C 15.945 7.494 16.333 8.386 16.333 9.478 C 16.333 13.319 13.995 14.165 11.77 14.411 C 12.12 14.711 12.445 15.324 12.445 16.261 C 12.445 17.599 12.433 18.674 12.433 18.999 C 12.433 19.262 12.608 19.574 13.12 19.474 C 17.121 18.163 19.983 14.413 19.983 10 C 19.983 4.478 15.506 0 9.983 0"/>
              </svg>
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
</nav>

  <!-- Mobile menu, show/hide based on menu state. -->
  <div id="mobile-menu" class="fixed z-10 w-full bg-bg top-16 -translate-y-[100vh] transition-transform duration-250 ease-in md:hidden pb-2 border-b border-b-fg px-2 pt-2 pb-3 h-[calc(100vh-4rem)] overflow-y-auto">
    
    
<nav class="flex-1 bg-bg space-y-2" aria-label="Sidebar">
    
        
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/"
   class="font-bold capitalize  border-transparent hover:bg-bg-highlight text-fg-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
            
            <span class="mr-3 flex-shrink-0 h-6 w-6">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-heroicon-name="academic-cap" data-heroicon-style="solid"><path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z"/></svg>
            </span>
        
        Documentation
</a>

        
        
            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/start/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Getting Started
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/fundamentals/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Fundamentals
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/render/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Render HTML
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/createstores/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Store Creation
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/events/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Event Handling
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/storemapping/"
   class=" pl-12 bg-bg-highlight border-fg text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Store Mapping
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/routing/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Routing
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/validation/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Validation
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/http/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Http
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/websockets/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Websockets
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/web-components/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Web Components
</a>

            
        
    
        
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/"
   class="font-bold capitalize  border-transparent hover:bg-bg-highlight text-fg-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
            
            <span class="mr-3 flex-shrink-0 h-6 w-6">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-heroicon-name="puzzle" data-heroicon-style="solid"><path d="M10 3.5a1.5 1.5 0 013 0V4a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-.5a1.5 1.5 0 000 3h.5a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-.5a1.5 1.5 0 00-3 0v.5a1 1 0 01-1 1H6a1 1 0 01-1-1v-3a1 1 0 00-1-1h-.5a1.5 1.5 0 010-3H4a1 1 0 001-1V6a1 1 0 011-1h3a1 1 0 001-1v-.5z"/></svg>
            </span>
        
        Headless Components
</a>

        
        
            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/checkboxgroup/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        CheckboxGroup
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/combobox/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Combobox
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/datacollection/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        DataCollection
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/disclosure/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Disclosure
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/inputfield/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        InputField
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/listbox/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Listbox (Select)
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/menu/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Menu
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/modal/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Modal
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/popover/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        PopOver
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/radioGroup/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        RadioGroup
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/switch/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Switch (Toggle)
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/tabgroup/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        TabGroup
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/textarea/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        TextArea
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/toast/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Toast
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/tooltip/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Tooltip
</a>

            
        
    
        
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/examples/"
   class="font-bold capitalize  border-transparent hover:bg-bg-highlight text-fg-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
            
            <span class="mr-3 flex-shrink-0 h-6 w-6">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-heroicon-name="color-swatch" data-heroicon-style="solid"><path fill-rule="evenodd" d="M4 2a2 2 0 00-2 2v11a3 3 0 106 0V4a2 2 0 00-2-2H4zm1 14a1 1 0 100-2 1 1 0 000 2zm5-1.757l4.9-4.9a2 2 0 000-2.828L13.485 5.1a2 2 0 00-2.828 0L10 5.757v8.486zM16 18H9.071l6-6H16a2 2 0 012 2v2a2 2 0 01-2 2z" clip-rule="evenodd"/></svg>
            </span>
        
        Examples
</a>

        
        
            
        
    
        
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/blog/"
   class="font-bold capitalize  border-transparent hover:bg-bg-highlight text-fg-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
            
            <span class="mr-3 flex-shrink-0 h-6 w-6">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-heroicon-name="newspaper" data-heroicon-style="solid"><path fill-rule="evenodd" d="M2 5a2 2 0 012-2h8a2 2 0 012 2v10a2 2 0 002 2H4a2 2 0 01-2-2V5zm3 1h6v4H5V6zm6 6H5v2h6v-2z" clip-rule="evenodd"/><path d="M15 7h1a2 2 0 012 2v5.5a1.5 1.5 0 01-3 0V7z"/></svg>
            </span>
        
        Blog
</a>

        
        
            
        
    
</nav>

    
  </div>

  <!-- 3 column wrapper -->
<div class="mt-16 h-[calc(100vh-4rem)] flex-grow w-full mx-auto md:flex">
  <!-- Left sidebar & main wrapper -->
    <div class="min-w-fit h-full overscroll-none overflow-y-auto w-64 xl:border-b-0 bg-bg hidden md:block">
        <!-- Start left column area -->
        <div class="mt-6 relative" style="min-height: 12rem;">
          
<nav class="flex-1 bg-bg space-y-2" aria-label="Sidebar">
    
        
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/"
   class="font-bold capitalize  border-transparent hover:bg-bg-highlight text-fg-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
            
            <span class="mr-3 flex-shrink-0 h-6 w-6">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-heroicon-name="academic-cap" data-heroicon-style="solid"><path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z"/></svg>
            </span>
        
        Documentation
</a>

        
        
            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/start/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Getting Started
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/fundamentals/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Fundamentals
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/render/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Render HTML
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/createstores/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Store Creation
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/events/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Event Handling
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/storemapping/"
   class=" pl-12 bg-bg-highlight border-fg text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Store Mapping
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/routing/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Routing
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/validation/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Validation
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/http/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Http
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/websockets/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Websockets
</a>

            
                
                
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/docs/web-components/"
   class=" pl-12 border-transparent hover:bg-bg-highlight text-relaxed hover:text-relaxed-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
        Web Components
</a>

            
        
    
        
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/headless/"
   class="font-bold capitalize  border-transparent hover:bg-bg-highlight text-fg-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
            
            <span class="mr-3 flex-shrink-0 h-6 w-6">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-heroicon-name="puzzle" data-heroicon-style="solid"><path d="M10 3.5a1.5 1.5 0 013 0V4a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-.5a1.5 1.5 0 000 3h.5a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-.5a1.5 1.5 0 00-3 0v.5a1 1 0 01-1 1H6a1 1 0 01-1-1v-3a1 1 0 00-1-1h-.5a1.5 1.5 0 010-3H4a1 1 0 001-1V6a1 1 0 011-1h3a1 1 0 001-1v-.5z"/></svg>
            </span>
        
        Headless Components
</a>

        
        
    
        
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/examples/"
   class="font-bold capitalize  border-transparent hover:bg-bg-highlight text-fg-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
            
            <span class="mr-3 flex-shrink-0 h-6 w-6">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-heroicon-name="color-swatch" data-heroicon-style="solid"><path fill-rule="evenodd" d="M4 2a2 2 0 00-2 2v11a3 3 0 106 0V4a2 2 0 00-2-2H4zm1 14a1 1 0 100-2 1 1 0 000 2zm5-1.757l4.9-4.9a2 2 0 000-2.828L13.485 5.1a2 2 0 00-2.828 0L10 5.757v8.486zM16 18H9.071l6-6H16a2 2 0 012 2v2a2 2 0 01-2 2z" clip-rule="evenodd"/></svg>
            </span>
        
        Examples
</a>

        
        
    
        
<!-- Current: "bg-indigo-50 border-indigo-600 text-indigo-600", Default: "border-transparent text-gray-600 hover:bg-gray-50 hover:text-gray-900" -->


<a href="/blog/"
   class="font-bold capitalize  border-transparent hover:bg-bg-highlight text-fg-highlight group flex items-center px-3 py-1 text-sm border-l-4 focus:">
    <!--
      Heroicon name: outline/home

      Current: "text-indigo-500", Default: "text-gray-400 group-hover:text-gray-500"
    -->
        
            
            <span class="mr-3 flex-shrink-0 h-6 w-6">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" data-heroicon-name="newspaper" data-heroicon-style="solid"><path fill-rule="evenodd" d="M2 5a2 2 0 012-2h8a2 2 0 012 2v10a2 2 0 002 2H4a2 2 0 01-2-2V5zm3 1h6v4H5V6zm6 6H5v2h6v-2z" clip-rule="evenodd"/><path d="M15 7h1a2 2 0 012 2v5.5a1.5 1.5 0 01-3 0V7z"/></svg>
            </span>
        
        Blog
</a>

        
        
    
</nav>

        </div>
        <!-- End left column area -->
    </div>


    
<div class="bg-bg md:min-w-0 md:flex-1 h-full">
  <div class="h-full py-6 px-5 sm:px-6 lg:px-8 h-full overscroll-none overflow-y-auto bg-bg lg:pr-72">
    <!-- Start main area-->
    <div class="relative content prose prose-invert max-w-prose pb-10">

      <h1>Store Mapping</h1>

      

      

      <h2 id="overview" tabindex="-1">Overview</h2>
<p>fritz2 uses stores to manage the application state by holding a data model. But quite often the data does
not fit into the desired UI-fragment out of the box. This is often due to the normalized form which avoids redundancy
as much as possible. Also, HTML can only render <code>Strings</code> at the end of the day, but the correct <code>String</code> representation
of data types differs from case to case, and we do not want to store those explicitly.</p>
<p>In order to support clean data management and compromise well between data and UI-shape, fritz2's stores
offer a powerful concept: store mapping.</p>
<p>Remember the <code>map</code>-function from collections where a source type <code>T</code> is transformed to another type <code>R</code>
inside of an expression? We can also <em>map</em> a store in order to change its source type to a more suitable type.
However, there is one big difference between the classical <code>map</code>-function and the store's mapping functions: A store
needs both a getter-function from <code>T -&gt; R</code> and a setter-function from <code>R -&gt; T</code> to manage changes.</p>
<h3 id="lenses" tabindex="-1">Lenses</h3>
<p>If you are unfamiliar with the universal concept for the functionality called <em>lens</em> in computer science, take
a look at the <a href="https://arrow-kt.io/learn/immutable-data/lens/">excellent documentation on lenses</a> from the
<a href="https://arrow-kt.io">arrow-project</a> before reading on. We are about to give you a short intro to lenses, and further
discuss them later in the Essentials section <a href="#lenses-in-depth">Lenses in Depth</a>.</p>
<p>fritz2 offers the method <code>lensOf()</code> for a short-and-sweet-experience which accepts a getter- and
a setter-expression:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> nameLens<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>Person<span class="token punctuation">,</span> String<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">lensOf</span><span class="token punctuation">(</span><span class="token punctuation">{</span> it<span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> person<span class="token punctuation">,</span> value <span class="token operator">-></span> person<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>name <span class="token operator">=</span> value<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>This lens can be used to access the <code>name</code>-property of a <code>Person</code>, or to create a new person with changed name:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> fritz2 <span class="token operator">=</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"fritz2"</span></span><span class="token punctuation">)</span><br><span class="token keyword">val</span> nameOfFritz2<span class="token operator">:</span> String <span class="token operator">=</span> nameLens<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span> <span class="token comment">// nameOfFritz2 = "fritz2"</span><br><span class="token keyword">val</span> hugo<span class="token operator">:</span> Person <span class="token operator">=</span> nameLens<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>fritz2<span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"hugo"</span></span><span class="token punctuation">)</span> <span class="token comment">// hugo = Person(1, "hugo")</span></code></pre>
<p>As you can see, there is no magic, just plain old function calling.</p>
<p>Let's take a step back and explore how the concept of lenses can be used to map one store to another.</p>
<h3 id="mapping-stores-using-lenses" tabindex="-1">Mapping Stores Using Lenses</h3>
<p>Imagine a use case where the interests of a person are rendered as tags - comma seperated values. They can be changed
by typing them as CSV.</p>
<p>But in order to further process these interests, it makes more sense to store them in a <code>List&lt;Interest&gt;</code>, so that will
be the canonical state representation in our application:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> interestsStore<span class="token operator">:</span> Store<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Interest<span class="token operator">></span><span class="token operator">></span> <span class="token operator">=</span> <span class="token function">storeOf</span><span class="token punctuation">(</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> job <span class="token operator">=</span> <span class="token function">Job</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<p>However, this representation does not fit the requirements of the specific UI-fragment - but no worries! Simply define
a <code>Lens</code> that does the mapping between the list and the <code>String</code> based CSV representation:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> interestLens<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Interest<span class="token operator">></span><span class="token punctuation">,</span> String<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">lensOf</span><span class="token punctuation">(</span><br>    List<span class="token operator">&lt;</span>Interest<span class="token operator">></span><span class="token operator">::</span>joinToString<span class="token punctuation">,</span> <span class="token comment">// getter</span><br>    <span class="token punctuation">{</span> it<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">","</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> Interest<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token comment">// setter</span><br><span class="token punctuation">)</span></code></pre>
<p>Armed with this lens, we can map the interest-store and use the resulting store in the UI:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> interestsStore<span class="token operator">:</span> Store<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Interest<span class="token operator">></span><span class="token operator">></span> <span class="token operator">=</span> <span class="token function">storeOf</span><span class="token punctuation">(</span><span class="token function">emptyList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> job <span class="token operator">=</span> <span class="token function">Job</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br><span class="token keyword">val</span> interestLens<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Interest<span class="token operator">></span><span class="token punctuation">,</span> String<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">lensOf</span><span class="token punctuation">(</span><br>    List<span class="token operator">&lt;</span>Interest<span class="token operator">></span><span class="token operator">::</span>joinToString<span class="token punctuation">,</span><br>    <span class="token punctuation">{</span> it<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">","</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> Interest<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><br><span class="token punctuation">)</span><br><br><span class="token keyword">val</span> csvInterests<span class="token operator">:</span> Store<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token operator">=</span> interestsStore<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>interestLens<span class="token punctuation">)</span><br><span class="token comment">//  ^^^^^^^^^^^^^^^^^^^^^^^^^^^                  ^^^^^^^^^^^^^^^^^</span><br><span class="token comment">//  Create a new store with the                  Use the `map` function to map the store</span><br><span class="token comment">//  desired type (2nd of the `Lens`)             and provide the lens for the transformations</span><br><br>render <span class="token punctuation">{</span><br>    h1 <span class="token punctuation">{</span> <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Choose Interests from:"</span></span> <span class="token punctuation">}</span><br>    p <span class="token punctuation">{</span> <span class="token operator">+</span>Interest<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">joinToString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>    input <span class="token punctuation">{</span><br>        label <span class="token punctuation">{</span> <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Interests:"</span></span> <span class="token punctuation">}</span><br>        <span class="token comment">// reactively connect the input to the mapped CSV representation store</span><br>        <span class="token function">value</span><span class="token punctuation">(</span>csvInterests<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <br>        changes<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span> handledBy csvInterests<span class="token punctuation">.</span>update<br>    <span class="token punctuation">}</span><br>    h1 <span class="token punctuation">{</span> <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Chosen Interests:"</span></span> <span class="token punctuation">}</span><br>    csvInterests<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">renderText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br>    <br>    <span class="token comment">// just to demonstrate that the original store is always in sync with the mapped one:</span><br>    interestsStore<span class="token punctuation">.</span>data handledBy <span class="token punctuation">{</span> interests <span class="token operator">-></span><br>        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>interests<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>As you can see, the mapped store fits perfectly to the desired (yet a little artificial) requirements for the UI:
There is no mapping inside the UI, nor are there any custom handlers or data-flows in the store.</p>
<p>But to be fair, the manual creation of the lens is heavy work. So fritz2 offers more tools to make lens generation
easier, especially for the use case of destructuring complex model types.</p>
<h2 id="essentials" tabindex="-1">Essentials</h2>
<h3 id="lenses-in-depth" tabindex="-1">Lenses in Depth</h3>
<p>Most of the time, a model for a view will not be of a simple data-type but a complex entity, like a
person having a name, multiple addresses, an email, a date of birth, etc.</p>
<p>In those cases, you will most likely need <code>Store</code>s for the properties of your main entity, and - later on - for
the properties of the child-entity like the street in an address in our example from above.</p>
<p>fritz2 again uses <code>Lens</code>es to describe the relationship between an entity and its child-entities and
properties.</p>
<p>A <code>Lens</code> is basically a way to describe the relation between an outer and inner entity in a structure. It focuses on the
inner entity from the viewpoint of the outer entity, which is how it got its name. Lenses are especially useful when
using immutable data-types like fritz2 does.</p>
<p>A <code>Lens</code> needs to handle the following:</p>
<ul>
<li>Getting the value of the inner entity from a given instance of the outer entity</li>
<li>Creating a new instance of the outer entity (immutable!) as a copy of a given one with a different value only for the
inner entity</li>
</ul>
<p>In fritz2, a <code>Lens</code> is defined by the following interface:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">interface</span> Lens<span class="token operator">&lt;</span>P<span class="token punctuation">,</span>T<span class="token operator">></span> <span class="token punctuation">{</span><br>    <span class="token keyword">val</span> id<span class="token operator">:</span> String<br>    <span class="token keyword">fun</span> <span class="token keyword">get</span><span class="token punctuation">(</span>parent<span class="token operator">:</span> P<span class="token punctuation">)</span><span class="token operator">:</span> T<br>    <span class="token keyword">fun</span> <span class="token keyword">set</span><span class="token punctuation">(</span>parent<span class="token operator">:</span> P<span class="token punctuation">,</span> value<span class="token operator">:</span> T<span class="token punctuation">)</span><span class="token operator">:</span> P<br><span class="token punctuation">}</span></code></pre>
<p>All you do to benefit is implement the functions <code>get()</code> and <code>set()</code>, or use the <code>lensOf()</code> function we discussed in
previous sections:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> nameLens <span class="token operator">=</span> <span class="token function">lensOf</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"name"</span></span><span class="token punctuation">,</span> <span class="token punctuation">{</span> it<span class="token punctuation">.</span>name <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> person<span class="token punctuation">,</span> value <span class="token operator">-></span> person<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>name <span class="token operator">=</span> value<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>No magic there. The first parameter sets an id for the <code>Lens</code>. When using <code>Lens</code>es with <code>Store</code>s,
the <code>id</code> will be used to generate a valid HTML <code>id</code> representing the path through your model.
This can be used to identify your elements semantically (for validation or automated ui-tests for example).</p>
<p>If you have deep nested structures or a lot of them, you may want to automate this behavior.</p>
<p>fritz2 offers a <code>@Lenses</code> annotation you can add to your data-classes, sealed-classes and sealed-interfaces in the
<code>commonMain</code> source-set of your multiplatform project:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">val</span> name<span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token keyword">val</span> value<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">companion</span> <span class="token keyword">object</span> <span class="token comment">// needs to be declared! The generated lens-factories are created within.</span><br><span class="token punctuation">}</span></code></pre>
<p>Using an annotation-processor, fritz2 builds factory methods for each public constructor property within the
companion object of the data class from these annotations which contains all the <code>Lens</code>es you need.
They are named exactly like the entities and properties, so it's easy to use:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> nameLens <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>You can see it in action at our <a href="/examples/nestedmodel">nestedmodel-example</a>.</p>
<p>Keep in mind that your annotated classes have to be in your <code>commonMain</code> source-set,
otherwise the automatic generation of the lenses will not work!</p>
<p>Have a look at the <a href="/examples/validation">validation-example</a> to see how to set it up.</p>
<p>This will also help you define a multiplatform project for sharing your model and validation code between
the browser and backend.</p>
<div class="info">
<p>There are other lenses generated as well. Especially when dealing with <code>sealed</code>-hierarchies, fritz2 offers more
helpful variants that are commonly needed to apply different idioms and patterns like <em>validation</em> or holding the base
type in some <code>Store</code> for type based UI design.</p>
<p>You can find out more in the two applications described in the sections
<a href="#dealing-with-sealed-type-hierarchies">Dealing with Sealed Type Hierarchies</a>
and <a href="/docs/validation/#delegating-validation-in-sealed-hierarchies">Delegating Validation in Sealed Hierarchies</a>.</p>
</div>
<h3 id="destructuring-complex-models-with-mapped-stores-and-lenses" tabindex="-1">Destructuring Complex Models With Mapped <code>Store</code>s and <code>Lense</code>s</h3>
<p>Having a <code>Lens</code> available which points to some specific property makes it very easy to get a <code>Store</code> for that
property from an original <code>Store</code> of the parent entity:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token comment">// given the following nested data classes...</span><br><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Name</span><span class="token punctuation">(</span><span class="token keyword">val</span> firstname<span class="token operator">:</span> String<span class="token punctuation">,</span> <span class="token keyword">val</span> lastname<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">companion</span> <span class="token keyword">object</span><br><span class="token punctuation">}</span><br><br><span class="token annotation builtin">@Lenses</span> <br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">val</span> name<span class="token operator">:</span> Name<span class="token punctuation">,</span> description<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">companion</span> <span class="token keyword">object</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// ... you can create a root-store...</span><br><span class="token keyword">val</span> personStore <span class="token operator">=</span> <span class="token function">storeOf</span><span class="token punctuation">(</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"first name"</span></span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"last name"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"more text"</span></span><span class="token punctuation">)</span><span class="token punctuation">,</span> job <span class="token operator">=</span> <span class="token function">Job</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><span class="token comment">// ... and a derived store using the automatic generated lens-factory `Person.name()`</span><br><span class="token keyword">val</span> nameStore <span class="token operator">=</span> personStore<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Person<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<p>Now you can use your <code>nameStore</code> exactly like any other <code>Store</code> to set up <em>two-way data binding</em>. Call <code>map(...)</code>
again to access the properties of <code>Name</code>. If a <code>Store</code> contains a <code>List</code>, you can of course iterate over it by
using <code>renderEach()</code>. It's fully recursive from here on down to the deepest nested parts of your model.</p>
<p><a href="/docs/createstores/#extend-none-custom-(local)-stores">Remember</a> that you can also add <code>Handler</code>s to your <code>Store</code>s
by simply calling the <code>handle</code> method:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> booleanChildStore <span class="token operator">=</span> parentStore<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>someLens<span class="token punctuation">)</span><br><span class="token keyword">val</span> switch <span class="token operator">=</span> booleanChildStore<span class="token punctuation">.</span><span class="token function">handle</span> <span class="token punctuation">{</span> model<span class="token operator">:</span> Boolean <span class="token operator">-></span> <br>    <span class="token operator">!</span>model<br><span class="token punctuation">}</span><br><br>render <span class="token punctuation">{</span><br>    button <span class="token punctuation">{</span><br>        <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"switch state"</span></span><br>        clicks handledBy switch<br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>To keep your code well-structured, it is recommended to implement complex logic in your <code>Store</code> or inherit it by
using interfaces. However, the code above is a decent solution for small (convenience-)handlers.</p>
<h3 id="calling-map-on-a-store-with-nullable-content" tabindex="-1">Calling <code>map</code> on a <code>Store</code> With Nullable Content</h3>
<p>Calling <code>map</code> on a nullable <code>Store</code> only makes sense when you have checked that its state is not null:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">val</span> name<span class="token operator">:</span> String<span class="token punctuation">)</span><br><br><span class="token comment">//...</span><br><br><span class="token keyword">val</span> storedPerson <span class="token operator">=</span> storeOf<span class="token operator">&lt;</span>Person<span class="token operator">?</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> job <span class="token operator">=</span> <span class="token function">Job</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br><span class="token comment">//...</span><br><br>storedPerson<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">render</span> <span class="token punctuation">{</span> person <span class="token operator">-></span><br>    <span class="token keyword">if</span> <span class="token punctuation">(</span>person <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// Avoid NullPointerExceptions reading or updating storedPerson</span><br>                          <span class="token comment">// by manually creating a safe scope ensuring that person is not null</span><br>        <span class="token keyword">val</span> storedName <span class="token operator">=</span> storedPerson<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Person<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>        input <span class="token punctuation">{</span><br>            <span class="token function">value</span><span class="token punctuation">(</span>storedName<span class="token punctuation">.</span>data<span class="token punctuation">)</span><br>            changes<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span> handledBy storedName<span class="token punctuation">.</span>update<br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br>    <span class="token keyword">else</span> <span class="token punctuation">{</span><br>        p <span class="token punctuation">{</span> <span class="token operator">+</span> <span class="token string-literal singleline"><span class="token string">"No customer selected"</span></span> <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<h3 id="handling-nullable-states-in-stores" tabindex="-1">Handling Nullable States in <code>Store</code>s</h3>
<p>If you have a <code>Store</code> with a nullable state, you can use <code>mapNull</code> to derive a non-nullable <code>Store</code> from it which
transparently translates a <code>null</code>-value from its parent <code>Store</code> to the given default-value and vice versa.</p>
<p>After text is entered into and then removed from the input of the following example, <code>nameStore</code> will have a state of
<code>null</code>:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> nameStore <span class="token operator">=</span> storeOf<span class="token operator">&lt;</span>String<span class="token operator">?</span><span class="token operator">></span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> job <span class="token operator">=</span> <span class="token function">Job</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br>render <span class="token punctuation">{</span><br>    input <span class="token punctuation">{</span><br>        nameStore<span class="token punctuation">.</span><span class="token function">mapNull</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">also</span> <span class="token punctuation">{</span> formStore <span class="token operator">-></span><br>            <span class="token function">value</span><span class="token punctuation">(</span>formStore<span class="token punctuation">.</span>data<span class="token punctuation">)</span><br>            changes<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span> handledBy formStore<span class="token punctuation">.</span>update<br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>In the real world, you will often come across nullable attributes of complex entities. Call <code>mapNull</code>
directly on the <code>Store</code> you create to use with your form elements:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">val</span> name<span class="token operator">:</span> String<span class="token operator">?</span><span class="token punctuation">)</span><br><br><span class="token comment">//...</span><br><br><span class="token keyword">val</span> personStore <span class="token operator">=</span> <span class="token function">storeOf</span><span class="token punctuation">(</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">,</span> job <span class="token operator">=</span> <span class="token function">Job</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br><span class="token comment">//...</span><br><br><span class="token keyword">val</span> nameStore <span class="token operator">=</span> personStore<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Person<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mapNull</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">)</span></code></pre>
<h4 id="the-other-way-around" tabindex="-1">The other way around</h4>
<p>You may also encounter special cases where you would like to apply the above-mentioned mapping the other way around:
e.g. when dealing with a non-nullable data model in combination with a nullable data-binding of a component such as a
combobox.</p>
<p>For those cases, use the <code>mapNullable</code> mapper function:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> nonNullableStore<span class="token operator">:</span> Store<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">storeOf</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">)</span><br><br><span class="token keyword">val</span> nullableStore<span class="token operator">:</span> Store<span class="token operator">&lt;</span>String<span class="token operator">?</span><span class="token operator">></span> <span class="token operator">=</span> <br>    nonNullableStore<span class="token punctuation">.</span><span class="token function">mapNullable</span><span class="token punctuation">(</span>placeholder <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Unknown"</span></span><span class="token punctuation">)</span><br><span class="token comment">//                               ^^^^^^^^^^^^^^^^^^^^^^^</span><br><span class="token comment">//                               When the parent has the specified placeholder value,</span><br><span class="token comment">//                               the mapped Store will have `null` as its value.</span></code></pre>
<h3 id="combining-lenses" tabindex="-1">Combining Lenses</h3>
<p>A <code>Lens</code> supports the <code>plus</code>-operator with another lens in order to create a new lens which combines the two.
The <code>get</code> and <code>set</code>-functions of the resulting lens are chained in natural order.</p>
<p>Imagine the following example:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Address</span><span class="token punctuation">(</span><span class="token keyword">val</span> street<span class="token operator">:</span> String<span class="token punctuation">)</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">val</span> address<span class="token operator">:</span> Address<span class="token punctuation">)</span><br><br><span class="token keyword">val</span> addressOfPerson<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>Person<span class="token punctuation">,</span> Address<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">lensOf</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"address"</span></span><span class="token punctuation">,</span> Person<span class="token operator">::</span>address<span class="token punctuation">)</span> <span class="token punctuation">{</span> p<span class="token punctuation">,</span> v <span class="token operator">-></span> p<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>address <span class="token operator">=</span> v<span class="token punctuation">)</span> <span class="token punctuation">}</span><br><span class="token keyword">val</span> streetOfAddress<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>Address<span class="token punctuation">,</span> String<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">lensOf</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"street"</span></span><span class="token punctuation">,</span> Address<span class="token operator">::</span>street<span class="token punctuation">)</span> <span class="token punctuation">{</span> p<span class="token punctuation">,</span> v <span class="token operator">-></span> p<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>street <span class="token operator">=</span> v<span class="token punctuation">)</span> <span class="token punctuation">}</span><br><br><span class="token comment">// combine two lenses:</span><br><span class="token keyword">val</span> streetOfPerson <span class="token operator">=</span> address <span class="token operator">+</span> street<br><br><span class="token comment">// apply the combined lens to an example object:</span><br><span class="token keyword">val</span> person <span class="token operator">=</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token function">Address</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Lerchenweg"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>streetOfPerson<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span> <span class="token comment">// -> "Lerchenweg"</span><br>streetOfPerson<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"Rosenstrae"</span></span><span class="token punctuation">)</span> <span class="token comment">// Person(address = Address("Rosenstrae"))</span></code></pre>
<p>Let's see how this example would work with automatically generated lenses.</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Address</span><span class="token punctuation">(</span><span class="token keyword">val</span> street<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">companion</span> <span class="token keyword">object</span> <span class="token punctuation">}</span><br><br><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">val</span> address<span class="token operator">:</span> Address<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">companion</span> <span class="token keyword">object</span> <span class="token punctuation">}</span><br><br><span class="token keyword">val</span> streetOfPerson <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> Address<span class="token punctuation">.</span><span class="token function">street</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>This works, but the syntax is quite cumbersome, especially for deeper nested models.</p>
<p>fritz2's automatic <code>@Lenses</code>-annotation-processor has dedicated support for deeper nested models as well and
creates extension functions for all lenses. This allows you to chain the calls fluently:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Address</span><span class="token punctuation">(</span><span class="token keyword">val</span> street<span class="token operator">:</span> String<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">companion</span> <span class="token keyword">object</span> <span class="token punctuation">}</span><br><br><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">val</span> address<span class="token operator">:</span> Address<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token keyword">companion</span> <span class="token keyword">object</span> <span class="token punctuation">}</span><br><br><span class="token keyword">val</span> streetOfPerson <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">address</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">street</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>This fluent API looks much terser and cleaner compared to the canonical one above. Note that, under the hood, nothing
special happens - the generated code simply uses the <code>plus</code> operator the same way you would.</p>
<p>Combining lenses is also very useful for formatting values, as we shall see in the next section.</p>
<h3 id="formatting-values" tabindex="-1">Formatting Values</h3>
<p>HTML allows only <code>String</code>s in your attributes, for example the <code>value</code> attribute of <code>input {}</code>. To use other data
types in your model, you have to specify how a type should be represented as <code>String</code> (e.g. Number, Currency, Date).
When working with <code>input {}</code>, you also need parse the user input back to your data type.
For all Kotlin basic types, there is a convenience function <code>asString()</code> which generates a <code>Lens</code> from this type to
<code>String</code> and vice versa. It internally calls the <code>T.toString()</code> and <code>String.toT()</code> functions.</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">val</span> age<span class="token operator">:</span> Int<span class="token punctuation">)</span><br><br><span class="token keyword">val</span> ageLens<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>Person<span class="token punctuation">,</span> Int<span class="token operator">></span> <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">age</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// cannot be used in tag attributes</span><br><span class="token keyword">val</span> ageLensAsString<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>Person<span class="token punctuation">,</span> String<span class="token operator">></span> <span class="token operator">=</span> Person<span class="token punctuation">.</span><span class="token function">age</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">asString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// now it is usable</span></code></pre>
<p>Also, remember that you can use the <code>lensOf()</code> function to create lenses which we introduced in the lenses section:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">fun</span> <span class="token operator">&lt;</span>P<span class="token operator">></span> <span class="token function">lensOf</span><span class="token punctuation">(</span>format<span class="token operator">:</span> <span class="token punctuation">(</span>P<span class="token punctuation">)</span> <span class="token operator">-></span> String<span class="token punctuation">,</span> parse<span class="token operator">:</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span> <span class="token operator">-></span> P<span class="token punctuation">)</span><span class="token operator">:</span> Lens<span class="token operator">&lt;</span>P<span class="token punctuation">,</span> String<span class="token operator">></span></code></pre>
<p>When using other types like <code>kotlinx.datetime.LocalDate</code>, special lenses for string conversion need to be specified for them:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">import</span> kotlinx<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span><span class="token operator">*</span><br><br><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Person</span><span class="token punctuation">(</span><span class="token keyword">val</span> birthday<span class="token operator">:</span> LocalDate<span class="token punctuation">)</span><br><br><span class="token keyword">object</span> Formats <span class="token punctuation">{</span><br>    <span class="token keyword">val</span> date<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>LocalDate<span class="token punctuation">,</span> String<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">lensOf</span><span class="token punctuation">(</span>LocalDate<span class="token operator">::</span>toString<span class="token punctuation">,</span> String<span class="token operator">::</span>toLocalDate<span class="token punctuation">)</span><br><span class="token punctuation">}</span></code></pre>
<p>Now you can use the <code>Formats.date</code> lens for deriving stores:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> personStore <span class="token operator">=</span> storeOf<span class="token operator">&lt;</span>Person<span class="token operator">></span><span class="token punctuation">(</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token function">LocalDate</span><span class="token punctuation">(</span><span class="token number">1990</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> job <span class="token operator">=</span> <span class="token function">Job</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br><span class="token keyword">val</span> birthday<span class="token operator">:</span> Store<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token operator">=</span> personStore<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Person<span class="token punctuation">.</span><span class="token function">birthday</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> Formats<span class="token punctuation">.</span>date<span class="token punctuation">)</span><br><span class="token comment">// or when an interim store is needed</span><br><span class="token keyword">val</span> birthday<span class="token operator">:</span> Store<span class="token operator">&lt;</span>String<span class="token operator">></span> <span class="token operator">=</span> personStore<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Person<span class="token punctuation">.</span><span class="token function">birthday</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Formats<span class="token punctuation">.</span>date<span class="token punctuation">)</span></code></pre>
<p>Take a look at our complete <a href="/examples/validation">validation example</a> to get an impression of that topic.</p>
<h3 id="summary-of-store-mapping-factories" tabindex="-1">Summary of Store-Mapping-Factories</h3>
<table>
<thead>
<tr>
<th>Factory</th>
<th>Use case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Store&lt;P&gt;.map(lens: Lens&lt;P, T&gt;): Store&lt;T&gt;</code></td>
<td>Most generic map-function. Maps any <code>Store</code> given a <code>Lens</code>. Use for model destructuring with automatic generated lenses for example.</td>
</tr>
<tr>
<td><code>Store&lt;P?&gt;.map(lens: Lens&lt;P &amp; Any, T&gt;): Store&lt;T&gt;</code></td>
<td>Maps any nullable <code>Store</code> given a <code>Lens</code> to a <code>Store</code> of a definitely none nullable <code>T</code>. Use in <code>render*</code>-content expressions combined with a null check.</td>
</tr>
<tr>
<td><code>Store&lt;List&lt;T&gt;&gt;.mapByElement(element: T, idProvider): Store&lt;T&gt;</code></td>
<td>Maps a <code>Store</code> of a <code>List&lt;T&gt;</code> to one element of that list. Works for entities, as a stable Id is needed.</td>
</tr>
<tr>
<td><code>Store&lt;List&lt;T&gt;&gt;.mapByIndex(index: Int): Store&lt;T&gt;</code></td>
<td>Maps a <code>Store</code> of a <code>List&lt;T&gt;</code> to one element of that list using the index.</td>
</tr>
<tr>
<td><code>Store&lt;Map&lt;K, V&gt;&gt;.mapByKey(key: K): Store&lt;V&gt;</code></td>
<td>Maps a <code>Store</code> of a <code>Map&lt;T&gt;</code> to one element of that map using the key.</td>
</tr>
<tr>
<td><code>Store&lt;T?&gt;.mapNull(default: T): Store&lt;T&gt;</code></td>
<td>Maps a <code>Store</code> of a nullable <code>T</code> to a <code>Store</code> of a definitely none nullable <code>T</code> using a default value in case of <code>null</code> in source-store.</td>
</tr>
<tr>
<td><code>Store&lt;T&gt;.mapNullable(placeholder: T): Store&lt;T?&gt;</code></td>
<td>Maps a <code>Store</code> of <code>T</code> to a <code>Store</code> of <code>T?</code>, replacing the given <code>placeholder</code> from the parent with <code>null</code> in the sub Store. This function is the reverse equivalent of <code>mapNull</code>.</td>
</tr>
<tr>
<td><code>MapRouter.mapByKey(key: String): Store&lt;String&gt;</code></td>
<td>Maps a <code>MapRouter</code> to a <code>Store</code>. See <a href="/docs/routing/#maprouter">chapter about routers</a> for more information.</td>
</tr>
</tbody>
</table>
<h3 id="summary-lens-factories" tabindex="-1">Summary Lens-Factories</h3>
<table>
<thead>
<tr>
<th>Factory</th>
<th>Use case</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>lensOf(id: String, getter: (P) -&gt; T, setter: (P, T) -&gt; P): Lens&lt;P, T&gt;</code></td>
<td>Most generic lens (used by <code>lenses-annotation-processor</code>. Fits for complex model destructuring.</td>
</tr>
<tr>
<td><code>lensOf(parse: (String) -&gt; P, format: (P) -&gt; String): Lens&lt;P, String&gt;</code></td>
<td>Formatting lens: Use for mapping into <code>String</code>s.</td>
</tr>
<tr>
<td><code>lensForElement(element: T, idProvider: IdProvider&lt;T, I&gt;): Lens&lt;List, T&gt;</code></td>
<td>Select one element from a list of entities, therefore a stable Id is needed.</td>
</tr>
<tr>
<td><code>lensForElement(index: Int): Lens&lt;List, T&gt;</code></td>
<td>Select one element from a list by index. Useful for value objects.</td>
</tr>
<tr>
<td><code>lensForElement(key: K): Lens&lt;Map&lt;K, V&gt;, V&gt;</code></td>
<td>Select one element from a map by key.</td>
</tr>
<tr>
<td><code>lensForUpcasting(): Lens&lt;Map&lt;P, C&gt;</code></td>
<td>Casting lens: Interpret parent as specific subtype. Handles <code>ClassCastException</code> for render edge-cases</td>
</tr>
</tbody>
</table>
<h2 id="advanced-topics" tabindex="-1">Advanced Topics</h2>
<h3 id="reactive-rendering-of-entity-lists-with-auto-mapped-element-store" tabindex="-1">Reactive Rendering of Entity-Lists With Auto-Mapped Element Store</h3>
<p>There is a special convenience method for the <a href="/docs/render/#reactive-rendering">reactive rendering</a> of lists of
entities which requires some knowledge about <code>Store</code>s and <code>Lens</code>es.</p>
<p>On a store of <code>List&lt;T&gt;</code>, an extension method called <code>renderEach</code> is defined directly on the
store. It is mandatory to pass an <code>idProvider</code>, so this is targeted to entity-types.</p>
<p>Inside the content-parameter expression of <code>renderEach</code>, instead of just <code>T</code>, a <code>Store&lt;T&gt;</code> gets injected. Some
store-mapping takes place under the hood: For each element of the original list, a mapped store
handling that element from the original store is created.</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> storedPersons<span class="token operator">:</span> Store<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Person<span class="token operator">></span><span class="token operator">></span> <span class="token operator">=</span> <span class="token function">storeOf</span><span class="token punctuation">(</span><span class="token function">listOf</span><span class="token punctuation">(</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"fritz2"</span></span><span class="token punctuation">,</span> <span class="token function">emptySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> job <span class="token operator">=</span> <span class="token function">Job</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br><span class="token comment">// needed for mapping an already mapped store to destructure the model further </span><br><span class="token keyword">val</span> nameLens<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>Person<span class="token punctuation">,</span> String<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">lensOf</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"name"</span></span><span class="token punctuation">,</span> Person<span class="token operator">::</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span> person<span class="token punctuation">,</span> name <span class="token operator">-></span> person<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>name <span class="token operator">=</span> name<span class="token punctuation">)</span> <span class="token punctuation">}</span><br><br>render <span class="token punctuation">{</span><br>    div <span class="token punctuation">{</span><br>        storedPersons<span class="token punctuation">.</span><span class="token function">renderEach</span><span class="token punctuation">(</span>Person<span class="token operator">::</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span> storedPerson <span class="token operator">-></span><br>        <span class="token comment">//            ^^^^^^^^^^^^^^^^^^^^^    ^^^^^^^^^^^^</span><br>        <span class="token comment">//            call directly on the     get a full `Store&lt;Person>`</span><br>        <span class="token comment">//            store                    for each element</span><br>            <br>            <span class="token keyword">val</span> storedName <span class="token operator">=</span> storedPerson<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>nameLens<span class="token punctuation">)</span> <span class="token comment">// create this store to map it further</span><br>            <br>            <span class="token comment">// provide an input element in order to modify one property of that person</span><br>            input <span class="token punctuation">{</span><br>                <span class="token function">value</span><span class="token punctuation">(</span>storedName<span class="token punctuation">.</span>data<span class="token punctuation">)</span><br>                changes<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span> handledBy storedName<span class="token punctuation">.</span>update<br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>Tables with editable cells are a typical use case for <code>Store&lt;List&lt;T&gt;&gt;.renderEach</code>.
Check out the boilerplate code that can be omitted in comparison to using the <code>Flow&lt;List&lt;T&gt;&gt;.renderEach</code>-function:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> storedPersons<span class="token operator">:</span> Store<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Person<span class="token operator">></span><span class="token operator">></span> <span class="token operator">=</span> <span class="token function">storeOf</span><span class="token punctuation">(</span><span class="token function">listOf</span><span class="token punctuation">(</span><span class="token function">Person</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string-literal singleline"><span class="token string">"fritz2"</span></span><span class="token punctuation">,</span> <span class="token function">emptySet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> job <span class="token operator">=</span> <span class="token function">Job</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br><br><span class="token keyword">val</span> nameLens<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>Person<span class="token punctuation">,</span> String<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">lensOf</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"name"</span></span><span class="token punctuation">,</span> Person<span class="token operator">::</span>name<span class="token punctuation">)</span> <span class="token punctuation">{</span> person<span class="token punctuation">,</span> name <span class="token operator">-></span> person<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>name <span class="token operator">=</span> name<span class="token punctuation">)</span> <span class="token punctuation">}</span><br><br>render <span class="token punctuation">{</span><br>    div <span class="token punctuation">{</span><br>        storedPersons<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">renderEach</span><span class="token punctuation">(</span>Person<span class="token operator">::</span>id<span class="token punctuation">)</span> <span class="token punctuation">{</span> person <span class="token operator">-></span> <span class="token comment">//  We get a `T`.. </span><br>            <br>            <span class="token comment">// ... thus we must create the mapped store manually:</span><br>            <span class="token keyword">val</span> storedPerson <span class="token operator">=</span> storedPersons<span class="token punctuation">.</span><span class="token function">mapByElement</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> Person<span class="token operator">::</span>id<span class="token punctuation">)</span><br>            <br>            <span class="token comment">// the same as above</span><br>            <span class="token keyword">val</span> storedName <span class="token operator">=</span> storedPerson<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>nameLens<span class="token punctuation">)</span><br>            input <span class="token punctuation">{</span><br>                <span class="token function">value</span><span class="token punctuation">(</span>storedName<span class="token punctuation">.</span>data<span class="token punctuation">)</span><br>                changes<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span> handledBy storedName<span class="token punctuation">.</span>update<br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>You might notice that the parameters of <code>renderEach</code> and <code>mapByElement</code> are identically. That's why it is possible
to encapsulate the store mapping directly into the former presented convenience function.</p>
<h3 id="dealing-with-sealed-type-hierarchies" tabindex="-1">Dealing with sealed Type Hierarchies</h3>
<p>There are special needs when you integrate <code>sealed</code> types into your model. It does not matter whether this is at the
root or nested inside your model-tree. There are always similar idioms that need to be applied. Those idioms need
special lenses, that will be generated by our <code>lenses-annotation-processor</code> for you.</p>
<p>Imagine the following example model:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">import</span> dev<span class="token punctuation">.</span>fritz2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>Lenses<br><span class="token keyword">import</span> dev<span class="token punctuation">.</span>fritz2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>NoLens<br><br><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">sealed</span> <span class="token keyword">interface</span> Wish <span class="token punctuation">{</span><br>    <span class="token keyword">val</span> label<span class="token operator">:</span> String<br>    <span class="token keyword">companion</span> <span class="token keyword">object</span><br><span class="token punctuation">}</span><br><br><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Wishlist</span><span class="token punctuation">(</span><br>  <span class="token keyword">val</span> name<span class="token operator">:</span> String<span class="token punctuation">,</span><br>  <span class="token keyword">val</span> wishes<span class="token operator">:</span> List<span class="token operator">&lt;</span>Wish<span class="token operator">></span><br><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>  <span class="token keyword">companion</span> <span class="token keyword">object</span><br><span class="token punctuation">}</span></code></pre>
<p>As you can see, we want to model a wishlist, which simply holds a list of wishes.
A <code>Wish</code> is a <code>sealed interface</code> that defines a <code>label</code> for all common children. It is also annotated by the known
<code>@Lenses</code>-annotation in order to tell the annotation processor to create lenses for this base type too.</p>
<p>The <code>WhishList</code> simply serves as a root node of the model to integrate the sealed hierarchy into another type.</p>
<div class="info">
<p>Our support for sealed type hierarchies has the following restriction:
All children of an annotated sealed base type need to be <code>data class</code>es that are themselves annotated with the <code>@Lenses</code>
annotation. The annotation processor will fail with an error if this constraint is violated.</p>
</div>
<p>There might be different kinds of wishes, though, which all differ in their special properties.
Take those for example:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Computer</span><span class="token punctuation">(</span><br>    <span class="token keyword">override</span> <span class="token keyword">val</span> label<span class="token operator">:</span> String<span class="token punctuation">,</span><br>    <span class="token keyword">val</span> ramInKb<span class="token operator">:</span> Int<br><span class="token punctuation">)</span> <span class="token operator">:</span> Wish <span class="token punctuation">{</span><br>    <span class="token keyword">companion</span> <span class="token keyword">object</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">enum</span> <span class="token keyword">class</span> Color <span class="token punctuation">{</span><br>  Blue<span class="token punctuation">,</span> Red<span class="token punctuation">,</span> Green<span class="token punctuation">,</span> Purple<span class="token punctuation">,</span> Yellow<span class="token punctuation">,</span> Petrol<br><span class="token punctuation">}</span><br><br><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">LightSaber</span><span class="token punctuation">(</span><br>  <span class="token keyword">override</span> <span class="token keyword">val</span> label<span class="token operator">:</span> String<span class="token punctuation">,</span><br>  <span class="token keyword">val</span> color<span class="token operator">:</span> Color<br><span class="token punctuation">)</span> <span class="token operator">:</span> Wish <span class="token punctuation">{</span><br>  <span class="token keyword">companion</span> <span class="token keyword">object</span><br><span class="token punctuation">}</span></code></pre>
<p>Our <code>WhishList.wishes</code> list can hold arbitrary objects of <code>Computer</code> and <code>LightSaber</code>, while both types need different
aspects to be well-defined:</p>
<ul>
<li>a computer needs RAM - as we refer to the good old homecomputer's era, we store those values in kilobytes.</li>
<li>a lightsaber needs a color - as fritz2's logo is somewhat <em>petrol</em>, we make this possible for our merch.</li>
</ul>
<p>Look at an example with a <code>Store</code> of type <code>WishList</code>:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> wishlist <span class="token operator">=</span> <span class="token function">Wishlist</span><span class="token punctuation">(</span><br>    <span class="token string-literal singleline"><span class="token string">"Christmas wishes"</span></span><span class="token punctuation">,</span><br>    <span class="token function">listOf</span><span class="token punctuation">(</span><br>        <span class="token function">LightSaber</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"fritz2"</span></span><span class="token punctuation">,</span> Color<span class="token punctuation">.</span>Petrol<span class="token punctuation">)</span><span class="token punctuation">,</span><br>        <span class="token function">Computer</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"C64"</span></span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><br>    <span class="token punctuation">)</span><br><span class="token punctuation">)</span><br><br><span class="token keyword">val</span> storedWishList<span class="token operator">:</span> Store<span class="token operator">&lt;</span>WishList<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">storeOf</span><span class="token punctuation">(</span>wishlist<span class="token punctuation">)</span></code></pre>
<p>We would like to implement a small UI to manage those wishes. It might look similar to this:
<img src="/img/sealed-hierarchy-example-app.png" alt="Wishlist App"></p>
<p>The overall example is rather good <a href="https://arrow-kt.io/learn/design/domain-modeling/">domain modelling</a>,
but it imposes some problems when it comes to store-mapping:</p>
<ol>
<li>To map the main model down to the nodes of the tree (<code>Whislist -&gt; wishes -&gt; some single wish -&gt; Computer -&gt; ramInKb</code>),
there is the need to map a store of the base type to a specific type. As mapping involves <code>Lens</code>es, we need
a <code>Lens&lt;Wish, Computer&gt;</code>, for example. How could this be done?</li>
<li>Another difficulty arises by the fact that we also want to modify the <em>common</em> properties of the base type.<br>
There is no implementation, though, so how should we implement the <code>setter</code> of a <code>Lens&lt;Wish, String&gt;</code> for the
<code>Whish.label</code>-property?</li>
</ol>
<p>There are solutions with simple idioms for those two problems that you can craft by hand. fritz2's lenses
processor creates the needed <code>Lens</code>es automatically for you, however.</p>
<p>The following two sections demonstrate the aforementioned solutions.</p>
<h4 id="up-casting-and-down-casting-lenses" tabindex="-1">Up-Casting and Down-Casting Lenses</h4>
<p>Let us recap the paths we need to take for a store-mapping from top to bottom elements:</p>
<ul>
<li><code>Whislist -&gt; wishes -&gt; some single wish -&gt; Computer -&gt; ramInKb</code></li>
<li><code>Whislist -&gt; wishes -&gt; some single wish -&gt; LightSaber -&gt; color</code></li>
</ul>
<p>We will need the following lenses to realize those mappings:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token comment">// Lenses to map to `WhishList`-properties</span><br><span class="token keyword">val</span> name<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>WhishList<span class="token punctuation">,</span> String<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">TODO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token keyword">val</span> wishes<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>WishList<span class="token punctuation">,</span> List<span class="token operator">&lt;</span>Wish<span class="token operator">></span><span class="token operator">></span> <span class="token operator">=</span> <span class="token function">TODO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br><span class="token comment">// Lenses to map to single `Wish`</span><br><span class="token keyword">val</span> singleWish<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>List<span class="token operator">&lt;</span>Wish<span class="token operator">></span><span class="token punctuation">,</span> Wish<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">TODO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br><span class="token comment">// Lenses to map to *specific* child type</span><br><span class="token comment">// This is das "hard" problem - we need to up-cast from base type to specific type</span><br><span class="token keyword">val</span> computer<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>Wish<span class="token punctuation">,</span> Computer<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">TODO</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// how could such an up-casting be implemented?</span><br><span class="token keyword">val</span> lightSaber<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>Wish<span class="token punctuation">,</span> LightSaber<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">TODO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br><span class="token comment">// Lenses to map to specific `Computer`-properties</span><br><span class="token keyword">val</span> ramInKb<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>Computer<span class="token punctuation">,</span> Int<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">TODO</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br><span class="token comment">// Lenses to map to specific `LightSaber`-properties</span><br><span class="token keyword">val</span> color<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>LightSaber<span class="token punctuation">,</span> Color<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">TODO</span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>The two problematic lenses are the ones that need to implement the up-casting from the base type to the specific type:</p>
<ul>
<li><code>Lens&lt;Wish, Computer&gt;</code></li>
<li><code>Lens&lt;Wish, LightSaber&gt;</code></li>
</ul>
<p>We need to know the specific type which we can typically solve with an appropriate <code>when</code>-expression.
Remember the type notation of the <code>getter</code>-property of a <code>Lens&lt;P, T&gt;</code> is <code>(P) -&gt; T</code> which would translate to
<code>(Wish) -&gt; Computer</code> in our example case. To obtain the correct return type, we can simply cast inside the
<code>getter</code>-expression of our <code>Lens</code> to the specific type:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> computerLens<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>Wish<span class="token punctuation">,</span> Computer<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">lensOf</span><span class="token punctuation">(</span><br>    id <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">,</span> <span class="token comment">// as this Lens does not change the "position" inside the tree, we preserve the overall `path`</span><br>    getter <span class="token operator">=</span> <span class="token punctuation">{</span> it <span class="token keyword">as</span> Computer <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token comment">//         ^^^^^^^^^^^^^^</span><br>    <span class="token comment">//         we need the getter to return the correct, specific type!</span><br>    <span class="token comment">//         as we know the type, we can simply cast the object held inside the `wishes`-list</span><br>    setter <span class="token operator">=</span> <span class="token punctuation">{</span> _<span class="token punctuation">,</span> v <span class="token operator">-></span> v <span class="token punctuation">}</span><br><span class="token punctuation">)</span></code></pre>
<p>As the <code>setter</code> has the type notion <code>(Wish, Computer) -&gt; Wish</code> we can simply return the value as it is. It already has
the correct specific type.</p>
<div class="info">
<p>Casting from the base type to a more specific type is called up-casting.
Since we apply this to a lens, we call this kind of lens <em>up-casting</em> lens.</p>
</div>
<p>But beware that the above code behaves still a bit brittle, as we do not cope with casting problems!
That's why fritz2 offers a dedicated lens factory for this use case: <code>lensForUpcasting</code>:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> computerLens<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>Wish<span class="token punctuation">,</span> Computer<span class="token operator">></span> <span class="token operator">=</span> lensForUpcasting<span class="token operator">&lt;</span>Wish<span class="token punctuation">,</span> Computer<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span></code></pre>
<p>Our automatic lens generator relies on this factory too. So strive to use this, if you craft your up-casting lenses
manually.</p>
<p>Armed with such an up-casting lenses, we can easily access or change values of our example <code>WishList</code>-object:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> wishlist <span class="token operator">=</span> <span class="token function">Wishlist</span><span class="token punctuation">(</span><br>    <span class="token string-literal singleline"><span class="token string">"Christmas wishes"</span></span><span class="token punctuation">,</span><br>    <span class="token function">listOf</span><span class="token punctuation">(</span><br>        <span class="token function">LightSaber</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"fritz2"</span></span><span class="token punctuation">,</span> Color<span class="token punctuation">.</span>Petrol<span class="token punctuation">)</span><span class="token punctuation">,</span><br>        <span class="token function">Computer</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"C64"</span></span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span> <span class="token comment">// index of 1 in list</span><br>    <span class="token punctuation">)</span><br><span class="token punctuation">)</span><br><br><span class="token keyword">val</span> upcastingLens<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>Wish<span class="token punctuation">,</span> Computer<span class="token operator">></span> <span class="token operator">=</span> lensForUpcasting<span class="token operator">&lt;</span>Wish<span class="token punctuation">,</span> Computer<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><br><span class="token comment">// craft a lens to access the `Computer.raminKb`-property from a `WishList` by combining the</span><br><span class="token comment">// intermediate lenses by `+`-operator:</span><br><span class="token keyword">val</span> ramInKbLens<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>Wishlist<span class="token punctuation">,</span> Int<span class="token operator">></span> <span class="token operator">=</span><br>    Wishlist<span class="token punctuation">.</span><span class="token function">wishes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token function">lensForElement</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">+</span> upcastingLens <span class="token operator">+</span> Computer<span class="token punctuation">.</span><span class="token function">ramInKb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><br><span class="token comment">//  ^^^^^^^^^^^^^^^^^   ^^^^^^^^^^^^^^^^^   ^^^^^^^^^^^^^   ^^^^^^^^^^^^^^^^^^</span><br><span class="token comment">//  |                   |                   |               generated by annotation </span><br><span class="token comment">//  |                   |                   |                </span><br><span class="token comment">//  |                   |                   apply our handcrafted up-casting lens to</span><br><span class="token comment">//  |                   |                   cast from `Wish` base type to `Computer`</span><br><span class="token comment">//  |                   |                                     </span><br><span class="token comment">//  |                   use fritz2's factory for index based lens creation</span><br><span class="token comment">//  |                   remember that the computer has index `1`!</span><br><span class="token comment">//  |</span><br><span class="token comment">//  generated by annotation</span><br><br><span class="token keyword">val</span> upgradedList <span class="token operator">=</span> ramInKbLens<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>wishlist<span class="token punctuation">,</span> <span class="token number">512</span><span class="token punctuation">)</span><br><br><span class="token function">println</span><span class="token punctuation">(</span>ramInKbLens<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>wishlist<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// prints: 64</span><br><span class="token function">println</span><span class="token punctuation">(</span>ramInKbLens<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>upgradedList<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// prints: 512</span></code></pre>
<p>As mentioned before, fritz2's annotation processor will generate those up-casting lenses for you.
They are named after the classname starting with a lowercase letter. Thus, <code>Computer</code> will have <code>computer()</code> as it's
factory name.</p>
<p>We can now use this to map the <code>Store</code> and provide some form elements to change the state:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> storedWishList<span class="token operator">:</span> Store<span class="token operator">&lt;</span>WishList<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">storeOf</span><span class="token punctuation">(</span>wishlist<span class="token punctuation">)</span><br><span class="token keyword">val</span> storedWishes <span class="token operator">=</span> storedWishList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Wishlist<span class="token punctuation">.</span><span class="token function">wishes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>storedWishList<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> it<span class="token punctuation">.</span>wishes<span class="token punctuation">.</span><span class="token function">withIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">renderEach</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>index<span class="token punctuation">,</span> wish<span class="token punctuation">)</span> <span class="token operator">-></span><br>    <span class="token keyword">val</span> storedWish <span class="token operator">=</span> storedWishes<span class="token punctuation">.</span><span class="token function">mapByIndex</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><br>    <span class="token keyword">when</span> <span class="token punctuation">(</span>wish<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token keyword">is</span> LightSaber <span class="token operator">-></span> <span class="token punctuation">{</span><br>            <span class="token comment">// we are now safe to up-cast to `LightSaber`-type!</span><br>            <span class="token keyword">val</span> storedColor <span class="token operator">=</span> storedWish<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Wish<span class="token punctuation">.</span><span class="token function">lightSaber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">color</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>            <span class="token comment">//                                    ^^^^^^^^^^^^</span><br>            <span class="token comment">//                                    use generated up-casting lens</span><br>            label <span class="token punctuation">{</span><br>                <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Color"</span></span><br>                <span class="token function">`for`</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">index</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br>            <span class="token function">select</span><span class="token punctuation">(</span>id <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">index</span></span><span class="token string">"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                changes<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> Color<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span> <span class="token punctuation">}</span> handledBy storedColor<span class="token punctuation">.</span>update<br>                Color<span class="token punctuation">.</span>entries<span class="token punctuation">.</span><span class="token function">forEach</span> <span class="token punctuation">{</span> color <span class="token operator">-></span><br>                    option <span class="token punctuation">{</span><br>                        <span class="token function">value</span><span class="token punctuation">(</span>color<span class="token punctuation">.</span>name<span class="token punctuation">)</span><br>                        <span class="token function">selected</span><span class="token punctuation">(</span>storedColor<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> it <span class="token operator">==</span> color <span class="token punctuation">}</span><span class="token punctuation">)</span><br>                        <span class="token operator">+</span>color<span class="token punctuation">.</span>name<br>                    <span class="token punctuation">}</span><br>                <span class="token punctuation">}</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br><br>        <span class="token keyword">is</span> Computer <span class="token operator">-></span> <span class="token punctuation">{</span><br>            <span class="token comment">// we are now safe to up-cast to `Computer`-type!</span><br>            <span class="token keyword">val</span> storedRam <span class="token operator">=</span> storedWish<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Wish<span class="token punctuation">.</span><span class="token function">computer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ramInKb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">asString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>            <span class="token comment">//                                  ^^^^^^^^^^</span><br>            <span class="token comment">//                                  use generated up-casting lens</span><br>            label <span class="token punctuation">{</span><br>                <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"RAM (KB)"</span></span><br>                <span class="token function">`for`</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">index</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br>            <span class="token function">input</span><span class="token punctuation">(</span>id <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">index</span></span><span class="token string">"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                <span class="token function">type</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"text"</span></span><span class="token punctuation">)</span><br>                <span class="token function">value</span><span class="token punctuation">(</span>storedRam<span class="token punctuation">.</span>data<span class="token punctuation">)</span><br>                changes<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span> handledBy storedRam<span class="token punctuation">.</span>update<br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<p>As there may be use-cases where we need to access the other way round, fritz2 also creates so called <em>down-casting</em>
lenses for each child of a sealed base type.</p>
<p>Those are lenses, that have a specific type as their parent and the base type as the lens's outcome.
Translated to the example there is a <code>Lens</code>-factory created on the type <code>LightSaber</code> called <code>wish()</code> that looks like
this:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">public</span> <span class="token keyword">fun</span> LightSaber<span class="token punctuation">.</span>Companion<span class="token punctuation">.</span><span class="token function">wish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Lens<span class="token operator">&lt;</span>LightSaber<span class="token punctuation">,</span> Wish<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">lensOf</span><span class="token punctuation">(</span><br>    <span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span> it <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    <span class="token punctuation">{</span> _<span class="token punctuation">,</span> v <span class="token operator">-></span> v <span class="token keyword">as</span> LightSaber <span class="token punctuation">}</span><br>    <span class="token comment">//        ^^^^^^^^^^^^^^^</span><br>    <span class="token comment">//        because `v`is of type `Wish` we need to cast it "back" into the specific parent type</span><br><span class="token punctuation">)</span></code></pre>
<h4 id="delegating-lenses" tabindex="-1">Delegating Lenses</h4>
<p>The second problem of sealed type hierarchies is the access of the <em>common</em> properties.</p>
<p>As a sealed base-type is an <code>interface</code> or an <code>abstract class</code> and <em>not a</em> <code>data class</code>, there is no <code>copy()</code>-function
we could use in order to provide a useful <code>setter</code> implementation!</p>
<p>Let us illustrate the problem for the <code>Wish.label</code>-property:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> labelLens<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>Wish<span class="token punctuation">,</span> String<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">lensOf</span><span class="token punctuation">(</span><br>    id <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"label"</span></span><span class="token punctuation">,</span><br>    getter <span class="token operator">=</span> Wish<span class="token operator">::</span>label<span class="token punctuation">,</span> <span class="token comment">// accessing is easy, but...</span><br>    setter <span class="token operator">=</span> <span class="token punctuation">{</span> parent<span class="token punctuation">,</span> value <span class="token operator">-></span> <span class="token function">TODO</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><br>    <span class="token comment">//                          ^^^^^^</span><br>    <span class="token comment">//                          ... there is no way to set the value back into the parent!</span><br><span class="token punctuation">)</span></code></pre>
<p>There is only one option: We must <em>delegate</em> the &quot;work&quot; to the children of the base type.</p>
<p>Remember: those need to be <code>data class</code>es, so we can rely on their <code>copy()</code>-capabilities to solve this problem:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> labelLens<span class="token operator">:</span> Lens<span class="token operator">&lt;</span>Wish<span class="token punctuation">,</span> String<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">lensOf</span><span class="token punctuation">(</span><br>    id <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"label"</span></span><span class="token punctuation">,</span><br>    getter <span class="token operator">=</span> <span class="token punctuation">{</span> parent <span class="token operator">-></span><br>        <span class="token comment">// separate the different types...</span><br>        <span class="token keyword">when</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">is</span> Computer <span class="token operator">-></span> parent<span class="token punctuation">.</span>label<br>            <span class="token comment">//             ^^^^^^^^^^^^</span><br>            <span class="token comment">//             ... and delegate the access to the child type</span><br>            <span class="token keyword">is</span> LightSaber <span class="token operator">-></span> parent<span class="token punctuation">.</span>label<br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><span class="token punctuation">,</span><br>    setter <span class="token operator">=</span> <span class="token punctuation">{</span> parent<span class="token punctuation">,</span> value <span class="token operator">-></span><br>        <span class="token comment">// separate the different types...</span><br>        <span class="token keyword">when</span><span class="token punctuation">(</span>parent<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">is</span> Computer <span class="token operator">-></span> parent<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>label <span class="token operator">=</span> value<span class="token punctuation">)</span><br>            <span class="token comment">//                    ^^^^</span><br>            <span class="token comment">//                    ... and delegate the setter work to the child type </span><br>            <span class="token comment">//                    by calling its `copy`-function.</span><br>            <span class="token keyword">is</span> LightSaber <span class="token operator">-></span> parent<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>label <span class="token operator">=</span> value<span class="token punctuation">)</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">)</span></code></pre>
<p>Because the work is <em>delegated</em> to the different child types, we call this kind of lens <em>delegating lens</em>.</p>
<p>As this is tedious to write, the fritz2's annotation processor will create those lenses for you. Because it needs to
be sure it can use the <code>copy()</code>-functions, there is the restriction that every child of a sealed base type needs
to be a <code>data class</code>!</p>
<p>You have already heard about this at the start of top level section, but now you understand the reason for that.</p>
<p>Now we can provide an input-field for the common <code>label</code>-property that gets mapped to the appropriate
child object's field:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token keyword">val</span> storedWishList<span class="token operator">:</span> Store<span class="token operator">&lt;</span>WishList<span class="token operator">></span> <span class="token operator">=</span> <span class="token function">storeOf</span><span class="token punctuation">(</span>wishlist<span class="token punctuation">)</span><br><span class="token keyword">val</span> storedWishes <span class="token operator">=</span> storedWishList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Wishlist<span class="token punctuation">.</span><span class="token function">wishes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>storedWishList<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> it<span class="token punctuation">.</span>wishes<span class="token punctuation">.</span><span class="token function">withIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">renderEach</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>index<span class="token punctuation">,</span> wish<span class="token punctuation">)</span> <span class="token operator">-></span><br>    <span class="token keyword">val</span> storedWish <span class="token operator">=</span> storedWishes<span class="token punctuation">.</span><span class="token function">mapByIndex</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><br>    <span class="token keyword">val</span> storedLabel <span class="token operator">=</span> storedWish<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Wish<span class="token punctuation">.</span><span class="token function">label</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>    <span class="token comment">//                               ^^^^^^^^^^^^</span><br>    <span class="token comment">//                               use the generated delegating-lens to get</span><br>    <span class="token comment">//                               a store of the common property for each instance</span><br>    label <span class="token punctuation">{</span><br>        <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Label"</span></span><br>        <span class="token function">`for`</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">index</span></span><span class="token string">-label"</span></span><span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br>    <span class="token function">input</span><span class="token punctuation">(</span>id <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">index</span></span><span class="token string">-label"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>        <span class="token function">type</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"text"</span></span><span class="token punctuation">)</span><br>        <span class="token function">value</span><span class="token punctuation">(</span>storedLabel<span class="token punctuation">.</span>data<span class="token punctuation">)</span><br>        changes<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span> handledBy storedLabel<span class="token punctuation">.</span>update<br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<h4 id="exclude-fields-from-lenses-generation" tabindex="-1">Exclude Fields from Lenses Generation</h4>
<p>Sometimes you may not want to create a <code>Lens</code> for each public field of a sealed base type.
Typical use cases may be properties that should be static for all instances, like some kind of display
name of the type.</p>
<p>For those cases fritz2 offers the <code>@NoLens</code>-annotation.</p>
<p>You can simply annotate any public property of a sealed base type to exclude this property from the
automatic lenses generation process.</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">sealed</span> <span class="token keyword">interface</span> Wish <span class="token punctuation">{</span><br>    <span class="token keyword">val</span> label<span class="token operator">:</span> String<br>    <br>    <span class="token comment">// Just annotate a property like this and no (delegating) lens is created</span><br>    <span class="token annotation builtin">@NoLens</span><br>    <span class="token keyword">val</span> typeName<span class="token operator">:</span> String<br>    <br>    <span class="token keyword">companion</span> <span class="token keyword">object</span><br><span class="token punctuation">}</span><br><br><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Computer</span><span class="token punctuation">(</span><br>    <span class="token keyword">override</span> <span class="token keyword">val</span> label<span class="token operator">:</span> String<span class="token punctuation">,</span><br>    <span class="token keyword">val</span> ramInKb<span class="token operator">:</span> Int<br><span class="token punctuation">)</span> <span class="token operator">:</span> Wish <span class="token punctuation">{</span><br>    <span class="token comment">// cannot be changed, so there is no need for a lens!</span><br>    <span class="token comment">// (and no implementation that would make any sense - no setter possible!)</span><br>    <span class="token keyword">override</span> <span class="token keyword">val</span> typeName<span class="token operator">:</span> String <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Computer"</span></span><br>  <br>    <span class="token keyword">companion</span> <span class="token keyword">object</span><br><span class="token punctuation">}</span></code></pre>
<h4 id="complete-wishlist-example" tabindex="-1">Complete Wishlist Example</h4>
<p>As this example is rather complex, the full working implementation of the preceding wishlist
code snippets can be found below. The styling is done with <a href="https://tailwindcss.com/">tailwindcss</a>, so you can copy and
paste it in our well known <a href="https://github.com/jwstegemann/fritz2-tailwind-template">fritz2-tailwind-template</a> project:</p>
<pre class="language-kotlin"><code class="language-kotlin"><span class="token comment">// somewhere in your `commonMain`-source-set:</span><br><span class="token keyword">import</span> dev<span class="token punctuation">.</span>fritz2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>Lenses<br><span class="token keyword">import</span> dev<span class="token punctuation">.</span>fritz2<span class="token punctuation">.</span>core<span class="token punctuation">.</span>NoLens<br><br><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">sealed</span> <span class="token keyword">interface</span> Wish <span class="token punctuation">{</span><br>    <span class="token keyword">val</span> label<span class="token operator">:</span> String<br>    <span class="token annotation builtin">@NoLens</span><br>    <span class="token keyword">val</span> typeName<span class="token operator">:</span> String<br>    <span class="token keyword">companion</span> <span class="token keyword">object</span><br><span class="token punctuation">}</span><br><br><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Computer</span><span class="token punctuation">(</span><br>    <span class="token keyword">override</span> <span class="token keyword">val</span> label<span class="token operator">:</span> String<span class="token punctuation">,</span><br>    <span class="token keyword">val</span> ramInKb<span class="token operator">:</span> Int<br><span class="token punctuation">)</span> <span class="token operator">:</span> Wish <span class="token punctuation">{</span><br>    <span class="token keyword">override</span> <span class="token keyword">val</span> typeName<span class="token operator">:</span> String <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Computer"</span></span><br>    <span class="token keyword">companion</span> <span class="token keyword">object</span><br><span class="token punctuation">}</span><br><br><span class="token keyword">enum</span> <span class="token keyword">class</span> Color <span class="token punctuation">{</span> <br>    Blue<span class="token punctuation">,</span> Red<span class="token punctuation">,</span> Green<span class="token punctuation">,</span> Purple<span class="token punctuation">,</span> Yellow<span class="token punctuation">,</span> Petrol<br><span class="token punctuation">}</span><br><br><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">LightSaber</span><span class="token punctuation">(</span><br>    <span class="token keyword">override</span> <span class="token keyword">val</span> label<span class="token operator">:</span> String<span class="token punctuation">,</span><br>    <span class="token keyword">val</span> color<span class="token operator">:</span> Color<br><span class="token punctuation">)</span> <span class="token operator">:</span> Wish <span class="token punctuation">{</span><br>    <span class="token keyword">override</span> <span class="token keyword">val</span> typeName<span class="token operator">:</span> String <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"Lightsaber"</span></span><br>    <span class="token keyword">companion</span> <span class="token keyword">object</span><br><span class="token punctuation">}</span><br><br><span class="token annotation builtin">@Lenses</span><br><span class="token keyword">data</span> <span class="token keyword">class</span> <span class="token function">Wishlist</span><span class="token punctuation">(</span><br>    <span class="token keyword">val</span> name<span class="token operator">:</span> String<span class="token punctuation">,</span><br>    <span class="token keyword">val</span> wishes<span class="token operator">:</span> List<span class="token operator">&lt;</span>Wish<span class="token operator">></span><br><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>    <span class="token keyword">companion</span> <span class="token keyword">object</span><br><span class="token punctuation">}</span><br><br><span class="token comment">// put this in your `App.kt` inside the `jsMain`-source-set:</span><br>render <span class="token punctuation">{</span><br>    <span class="token keyword">val</span> wishlist <span class="token operator">=</span> <span class="token function">Wishlist</span><span class="token punctuation">(</span><br>        <span class="token string-literal singleline"><span class="token string">"Christmas wishes"</span></span><span class="token punctuation">,</span><br>        <span class="token function">listOf</span><span class="token punctuation">(</span><br>            <span class="token function">LightSaber</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"fritz2"</span></span><span class="token punctuation">,</span> Color<span class="token punctuation">.</span>Petrol<span class="token punctuation">)</span><span class="token punctuation">,</span><br>            <span class="token function">Computer</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"C64"</span></span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><br>        <span class="token punctuation">)</span><br>    <span class="token punctuation">)</span><br><br>    <span class="token keyword">val</span> storedWishList <span class="token operator">=</span> <span class="token function">storeOf</span><span class="token punctuation">(</span>wishlist<span class="token punctuation">)</span><br>    <span class="token keyword">val</span> addWish <span class="token operator">=</span> storedWishList<span class="token punctuation">.</span>handle<span class="token operator">&lt;</span>Wish<span class="token operator">></span> <span class="token punctuation">{</span> state<span class="token punctuation">,</span> new <span class="token operator">-></span><br>        state<span class="token punctuation">.</span><span class="token function">copy</span><span class="token punctuation">(</span>wishes <span class="token operator">=</span> state<span class="token punctuation">.</span>wishes <span class="token operator">+</span> new<span class="token punctuation">)</span><br>    <span class="token punctuation">}</span><br><br>    form <span class="token punctuation">{</span><br>        <span class="token function">div</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"bg-gray-200 m-4 p-4 rounded-md grid grid-cols-4 items-baseline"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token keyword">val</span> storedName <span class="token operator">=</span> storedWishList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Wishlist<span class="token punctuation">.</span><span class="token function">name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>            label <span class="token punctuation">{</span><br>                <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Wishlist's name"</span></span><br>                <span class="token function">`for`</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"name"</span></span><span class="token punctuation">)</span><br>            <span class="token punctuation">}</span><br>            <span class="token function">input</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"col-span-3 p-2 rounded"</span></span><span class="token punctuation">,</span> id <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"name"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                <span class="token function">type</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"text"</span></span><span class="token punctuation">)</span><br>                <span class="token function">value</span><span class="token punctuation">(</span>storedName<span class="token punctuation">.</span>data<span class="token punctuation">)</span><br>                changes<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span> handledBy storedName<span class="token punctuation">.</span>update<br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br><br>        <span class="token keyword">val</span> storedWishes <span class="token operator">=</span> storedWishList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Wishlist<span class="token punctuation">.</span><span class="token function">wishes</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>        storedWishes<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> it<span class="token punctuation">.</span><span class="token function">withIndex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">renderEach</span> <span class="token punctuation">{</span> <span class="token punctuation">(</span>index<span class="token punctuation">,</span> wish<span class="token punctuation">)</span> <span class="token operator">-></span><br>            <span class="token keyword">val</span> storedWish <span class="token operator">=</span> storedWishes<span class="token punctuation">.</span><span class="token function">mapByIndex</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><br>            <span class="token function">div</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"bg-gray-200 m-4 p-4 rounded-md grid grid-cols-4"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                <span class="token function">ul</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"grid grid-cols-subgrid col-span-4 gap-2"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                    <span class="token function">li</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"grid grid-cols-subgrid col-span-2 items-baseline"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                        <span class="token keyword">val</span> storedLabel <span class="token operator">=</span> storedWish<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Wish<span class="token punctuation">.</span><span class="token function">label</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>                        label <span class="token punctuation">{</span><br>                            <span class="token operator">+</span>wish<span class="token punctuation">.</span>typeName<br>                            <span class="token function">`for`</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">index</span></span><span class="token string">-label"</span></span><span class="token punctuation">)</span><br>                        <span class="token punctuation">}</span><br>                        <span class="token function">input</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"p-2 rounded"</span></span><span class="token punctuation">,</span> id <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">index</span></span><span class="token string">-label"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                            <span class="token function">type</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"text"</span></span><span class="token punctuation">)</span><br>                            <span class="token function">value</span><span class="token punctuation">(</span>storedLabel<span class="token punctuation">.</span>data<span class="token punctuation">)</span><br>                            changes<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span> handledBy storedLabel<span class="token punctuation">.</span>update<br>                        <span class="token punctuation">}</span><br>                    <span class="token punctuation">}</span><br>                    <span class="token function">li</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"grid grid-cols-subgrid col-span-2 items-baseline"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                        <span class="token keyword">when</span> <span class="token punctuation">(</span>wish<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                            <span class="token keyword">is</span> LightSaber <span class="token operator">-></span> <span class="token punctuation">{</span><br>                                <span class="token keyword">val</span> storedColor <span class="token operator">=</span> storedWish<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Wish<span class="token punctuation">.</span><span class="token function">lightSaber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">color</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>                                label <span class="token punctuation">{</span><br>                                    <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"Color"</span></span><br>                                    <span class="token function">`for`</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">index</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><br>                                <span class="token punctuation">}</span><br>                                <span class="token function">select</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"w-full p-2 rounded"</span></span><span class="token punctuation">,</span> id <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">index</span></span><span class="token string">"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                                    changes<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> Color<span class="token punctuation">.</span><span class="token function">valueOf</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span> <span class="token punctuation">}</span> handledBy storedColor<span class="token punctuation">.</span>update<br>                                    Color<span class="token punctuation">.</span>entries<span class="token punctuation">.</span><span class="token function">forEach</span> <span class="token punctuation">{</span> color <span class="token operator">-></span><br>                                        option <span class="token punctuation">{</span><br>                                            <span class="token function">value</span><span class="token punctuation">(</span>color<span class="token punctuation">.</span>name<span class="token punctuation">)</span><br>                                            <span class="token function">selected</span><span class="token punctuation">(</span>storedColor<span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> it <span class="token operator">==</span> color <span class="token punctuation">}</span><span class="token punctuation">)</span><br>                                            <span class="token operator">+</span>color<span class="token punctuation">.</span>name<br>                                        <span class="token punctuation">}</span><br>                                    <span class="token punctuation">}</span><br>                                <span class="token punctuation">}</span><br>                            <span class="token punctuation">}</span><br><br>                            <span class="token keyword">is</span> Computer <span class="token operator">-></span> <span class="token punctuation">{</span><br>                                <span class="token keyword">val</span> storedRam <span class="token operator">=</span> storedWish<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span>Wish<span class="token punctuation">.</span><span class="token function">computer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">ramInKb</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">asString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><br>                                label <span class="token punctuation">{</span><br>                                    <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"RAM (KB)"</span></span><br>                                    <span class="token function">`for`</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">index</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><br>                                <span class="token punctuation">}</span><br>                                <span class="token function">input</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"p-2 rounded"</span></span><span class="token punctuation">,</span> id <span class="token operator">=</span> <span class="token string-literal singleline"><span class="token string">"</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">$</span><span class="token expression">index</span></span><span class="token string">"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                                    <span class="token function">type</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"text"</span></span><span class="token punctuation">)</span><br>                                    <span class="token function">value</span><span class="token punctuation">(</span>storedRam<span class="token punctuation">.</span>data<span class="token punctuation">)</span><br>                                    changes<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span> handledBy storedRam<span class="token punctuation">.</span>update<br>                                <span class="token punctuation">}</span><br>                            <span class="token punctuation">}</span><br>                        <span class="token punctuation">}</span><br>                    <span class="token punctuation">}</span><br>                <span class="token punctuation">}</span><br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>        <span class="token function">div</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"bg-gray-200 m-4 p-4 rounded-md grid grid-cols-4 gap-2 items-baseline"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>            <span class="token function">button</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"border border-black bg-white p-2 rounded"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"+ Lightsaber"</span></span><br>                clicks<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> <span class="token function">LightSaber</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">,</span> Color<span class="token punctuation">.</span>Blue<span class="token punctuation">)</span> <span class="token punctuation">}</span> handledBy addWish<br>            <span class="token punctuation">}</span><br>            <span class="token function">button</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">"border border-black bg-white p-2 rounded"</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>                <span class="token operator">+</span><span class="token string-literal singleline"><span class="token string">"+ Computer"</span></span><br>                clicks<span class="token punctuation">.</span><span class="token function">map</span> <span class="token punctuation">{</span> <span class="token function">Computer</span><span class="token punctuation">(</span><span class="token string-literal singleline"><span class="token string">""</span></span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">}</span> handledBy addWish<br>            <span class="token punctuation">}</span><br>        <span class="token punctuation">}</span><br>    <span class="token punctuation">}</span><br><span class="token punctuation">}</span></code></pre>
<div class="warning">
<p>The above example is intentionally simply structured in order to reduce complexity and show the code in a
straight-forward manner.</p>
<p>For real world application we encourage you to apply better <a href="/docs/render/#structure-ui">structure</a> and divide the UI
into smaller and reusable parts, of course.</p>
</div>


    </div>
    <a class="group flex items-center px-1 py-1 pb-6 text-sm text-cyan-300 hover:underline" href="https://github.com/jwstegemann/fritz2/blob/master/www/src/pages/docs/50_StoreMapping.md" target="_blank">
      <span class="mr-1 flex-shrink-0 h-4 w-4">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L6.832 19.82a4.5 4.5 0 01-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 011.13-1.897L16.863 4.487zm0 0L19.5 7.125" />
        </svg>
      </span>
      Edit this page on Github
    </a>
    <!-- End main area -->
  </div>
</div>

<div
    class="fixed lg:block top-0 right-0 pt-16 h-full hidden pr-4 sm:pr-6 lg:pr-8 lg:pr-2">
    <div class="w-64 h-full overscroll-none overflow-y-auto pl-6 py-6">
        <!-- Start right column area -->
        <div class="h-full relative" style="min-height: 16rem;">

            <h2 class="text-sm font-bold capitalize text-fg-highlight mb-4">On this Page</h2>

            <nav class="toc" >
        <ul><li><a href="#overview">Overview</a><ul><li><a href="#lenses">Lenses</a></li><li><a href="#mapping-stores-using-lenses">Mapping Stores Using Lenses</a></li></ul></li><li><a href="#essentials">Essentials</a><ul><li><a href="#lenses-in-depth">Lenses in Depth</a></li><li><a href="#destructuring-complex-models-with-mapped-stores-and-lenses">Destructuring Complex Models With Mapped Stores and Lenses</a></li><li><a href="#calling-map-on-a-store-with-nullable-content">Calling map on a Store With Nullable Content</a></li><li><a href="#handling-nullable-states-in-stores">Handling Nullable States in Stores</a><ul><li><a href="#the-other-way-around">The other way around</a></li></ul></li><li><a href="#combining-lenses">Combining Lenses</a></li><li><a href="#formatting-values">Formatting Values</a></li><li><a href="#summary-of-store-mapping-factories">Summary of Store-Mapping-Factories</a></li><li><a href="#summary-lens-factories">Summary Lens-Factories</a></li></ul></li><li><a href="#advanced-topics">Advanced Topics</a><ul><li><a href="#reactive-rendering-of-entity-lists-with-auto-mapped-element-store">Reactive Rendering of Entity-Lists With Auto-Mapped Element Store</a></li><li><a href="#dealing-with-sealed-type-hierarchies">Dealing with sealed Type Hierarchies</a><ul><li><a href="#up-casting-and-down-casting-lenses">Up-Casting and Down-Casting Lenses</a></li><li><a href="#delegating-lenses">Delegating Lenses</a></li><li><a href="#exclude-fields-from-lenses-generation">Exclude Fields from Lenses Generation</a></li><li><a href="#complete-wishlist-example">Complete Wishlist Example</a></li></ul></li></ul></li></ul>
      </nav>

        </div>
        <!-- End right column area -->
    </div>
</div>


  </div>
</div>


<script src="/assets/main.js"></script>
</body>
</html>
